!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("wafer-sticky",[],e):"object"==typeof exports?exports["wafer-sticky"]=e():(t.wafer=t.wafer||{},t.wafer.wafers=t.wafer.wafers||{},t.wafer.wafers["wafer-sticky"]=e())}("undefined"!=typeof self?self:this,function(){return function(t){function e(r){if(o[r])return o[r].exports;var i=o[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var o={};return e.m=t,e.c=o,e.d=function(t,o,r){e.o(t,o)||Object.defineProperty(t,o,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var o=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(o,"a",o),o},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="https://s.yimg.com/aaq/wf/",e(e.s="./src/entry.js")}({"./src/base.js":function(t,e,o){"use strict";function r(t){if(Array.isArray(t)){for(var e=0,o=Array(t.length);e<t.length;e++)o[e]=t[e];return o}return Array.from(t)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var a=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&(t[r]=o[r])}return t},l=function(){function t(t,e){var o=[],r=!0,i=!1,n=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(o.push(s.value),!e||o.length!==e);r=!0);}catch(t){i=!0,n=t}finally{try{!r&&a.return&&a.return()}finally{if(i)throw n}}return o}return function(e,o){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,o);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),c=function(){function t(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,o,r){return o&&t(e.prototype,o),r&&t(e,r),e}}(),f=function t(e,o,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,o);if(void 0===i){var n=Object.getPrototypeOf(e);return null===n?void 0:t(n,o,r)}if("value"in i)return i.value;var s=i.get;if(void 0!==s)return s.call(r)},u=window.wafer,y=u.constants,d=u.features,p=u.utils,v=u.WaferBaseClass,h=p.findAncestor,b=y.ATTR_PREFIX,g=function(t){function e(t){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=o.selector;i(this,e);var s=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,{selector:r},{})),c=t.getAttribute(b+"sticky-boundary"),f=t.getAttribute(b+"sticky-target"),u=t.getAttribute(b+"sticky-position"),y=(t.getAttribute(b+"sticky-offset")||"").split(" "),d=l(y,4),p=d[0],v=d[1],g=d[2],m=d[3],_=t.getAttribute(b+"sticky-body-classname")||"";_&&(_=_.split(" ")),s._util=a({},s._util,{bodyClassname:_,elem:t,targetElem:f&&(c&&h(t,c)||document.body).querySelector(f)||t,offsetBottom:void 0!==m&&m,offsetLeft:void 0!==v&&v,offsetRight:void 0!==g&&g,offsetTop:void 0!==p&&p,stickyPosition:u});var w=s._util.targetElem,k=w.style,O=k.bottom,j=k.left,S=k.position,P=k.right,E=k.top,x=k.width,T=w.getBoundingClientRect(),C=T.height,A=t.getBoundingClientRect(),R=A.height;return s._util.stickyAllowed=C<=R,s._state={isSticky:!1,targetElemOffsetTop:w.offsetTop,previousPositionValue:{bottom:O,left:j,position:S,right:P,top:E,width:x},scrollContainerObserver:null},t===w&&s.addEventListeners(),s}return s(e,t),c(e,[{key:"addEventListeners",value:function(){var t=this;if(d.mutationObserver){var e=this._util.targetElem;this._state.scrollContainerObserver=new MutationObserver(function(){t._state.isSticky&&t.addSticky("resize")}),this._state.scrollContainerObserver.observe(e,{childList:!0,subtree:!0})}}},{key:"updateStickyProperties",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this._util.targetElem;Object.assign(e.style,{width:"",position:""}),Object.assign(e.style,{position:"fixed",width:e.offsetWidth+"px"},t)}},{key:"destroy",value:function(){var t=this._state.scrollContainerObserver;t&&t.disconnect(),f(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this)}},{key:"addSticky",value:function(t){var e="resize"===t,o=this._state.isSticky;if(e||!o){var i=this._util,n=i.bodyClassname,s=i.elem,a=i.offsetLeft,l=i.offsetRight,c=i.offsetTop,f=i.stickyPosition,u=i.targetElem,y={};if(o||(this._state.targetElemOffsetTop=u.offsetTop),"bottom"===f?y.bottom="0":c&&(y.top=c),a?y.left=a:l&&(y.right=l),this._state.isSticky=!0,s!==u?Object.assign(u.style,{position:"fixed"},y):this.updateStickyProperties(y),u.classList.add("sticky-active"),n){var d;(d=document.body.classList).add.apply(d,r(n))}}}},{key:"makeStickyFlow",value:function(){var t=this._util,e=t.bodyClassname,o=t.elem,i=t.offsetBottom,n=t.offsetLeft,s=t.offsetRight,a=t.stickyPosition,l=t.targetElem,c=o.getBoundingClientRect(),f=l.getBoundingClientRect(),u=f.height,y=c.bottom,d={};if("bottom"===a?d.bottom=parseInt(i,10)+"px":d.top=y-u-parseInt(i,10)+"px",n?d.left=n:s&&(d.right=s),this._state.isSticky=!0,Object.assign(l.style,{position:"fixed"},d),l.classList.add("sticky-flow"),e){var p;(p=document.body.classList).add.apply(p,r(e))}}},{key:"removeSticky",value:function(){if(this._state.isSticky){var t=this._util,e=t.bodyClassname,o=t.targetElem;if(o.classList.remove("sticky-flow","sticky-active"),e){var i;(i=document.body.classList).remove.apply(i,r(e))}this._state.isSticky=!1,Object.assign(o.style,this._state.previousPositionValue)}}},{key:"config",get:function(){var t=this._util,e=t.offsetBottom,o=t.offsetTop,r=t.stickyAllowed,i=t.targetElem;return{isSticky:this._state.isSticky,offsetBottom:e,offsetTop:o,stickyAllowed:r,targetElem:i}}}]),e}(v);e.default=g,t.exports=e.default},"./src/controller.js":function(t,e,o){"use strict";function r(){return l=i(o("./src/base.js"))}function i(t){return t&&t.__esModule?t:{default:t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var l,c=function(){function t(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,o,r){return o&&t(e.prototype,o),r&&t(e,r),e}}(),f=window.wafer,u=f.base,y=f.controllers,d=f.utils,p=d.elementInView,v=d.throttle,h=y.WaferBaseController,b=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=t.root,i=void 0===o?document:o,a=t.selector,c=t.validateDelay,f=void 0===c?15:c;n(this,e);var u=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,{root:i,selector:a,props:{selector:a},WaferClass:(l||r()).default}));return u._validateWithThrottle=v(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.source;u.validate({source:e})},f,u),u.sync(),u}return a(e,t),c(e,[{key:"handleScroll",value:function(){this._validateWithThrottle()}},{key:"handleResize",value:function(){this._validateWithThrottle({source:"resize"})}},{key:"didSync",value:function(){var t=this._state,e=t.elementInstances,o=t.mounted;0!==e.size&&!o&&(this._state.mounted=!0)}},{key:"handleSelfSticky",value:function(t,e,o){if(window.pageYOffset+window.innerHeight>t+e._state.targetElemOffsetTop)return void e.addSticky(o);e.removeSticky(o)}},{key:"willValidate",value:function(t){var e=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=o.source,i=this._state.elementInstances;t.forEach(function(t){var o=i.get(t),n=o.instance,s=p(t,{},u.viewport),a=n.config,l=a.isSticky,c=a.stickyAllowed;if(!s||!c)return void(l&&n.removeSticky());var f=n.config.targetElem,y=f.getBoundingClientRect(),d=y.height;if(f!==t){var v=t.getBoundingClientRect(),h=v.bottom,b=v.top;if(v.height<=d)return;var g=n.config,m=g.offsetTop,_=g.offsetBottom;_=_&&parseInt(_,10),m=m&&parseInt(m,10),h-(d+_+m)<0?n.makeStickyFlow(r):l&&b-m>=0?n.removeSticky(r):b-m<0&&n.addSticky(r)}else e.handleSelfSticky(d,n,r)})}}]),e}(h);e.default=b,t.exports=e.default},"./src/entry.js":function(t,e,o){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i;e.default=new((i||function(){return i=r(o("./src/controller.js"))}()).default)({selector:".wafer-sticky"}),t.exports=e.default}})});